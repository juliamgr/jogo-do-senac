<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    <div class="armario">
        
        <IMG  class="armario2" src="lockeruou.png">
            <IMG  class="armario2" src="lockeruou.png">
                <IMG  class="armario2" src="lockeruou.png">
                    <IMG  class="armario2" src="lockeruou.png">
                        <IMG  class="armario2" src="lockeruou.png">
                            <IMG  class="lixo" src="LIXEIRA-AZUL-50L-SEM-POSTE-JSN (1).png">
                            
                    
    </div>
    <div id="botao-interacao">Pressione F para Interagir</div>
<div id="textbox">
    <h1></h1>
   
    <button id="open-button" class="hidden">Falar</button>
</div>
    <div class="visoria">
        <img  class="vioria" src="vitoria anitter.png" width="300" height="200" />
    </div>
    <div class="julia paia">
        <img class="jolia" src="julia tristona.png">
    </div>
    <div id="elemento" class="elemento">
                
        <!-- Trigger/Open The Modal -->
        <button id="myBtn">Open Modal</button>
        <button id="botao" class="botao" style="display: none;">Clique Aqui</button>
      </div>
   
    <div class="entrada" img src="wall.png">
        
        <div class="door"></div>
       
    </div>
    <img class="tia" src="tiaartic.png">
    
    

   
    
        
    </DIV>
    <title>Quadrado Móvel</title>
    <style>
            *{
                cursor: url('png-clipart-club-penguin-island-flathead-grey-mullet-fish-dead-fish-game-animals.png'),auto;
            }
   .lixo{
        display: block;
        float: left;
        
        height: 15%;
        width: 10%;
       margin-top:-9%;
       margin-left:87%;

}
.vioria{
    position: absolute;
          overflow: hidden;
           height: 150px;
            width: 100px; /* largura do quadrado */
             /* altura do quadrado */ 
            /* cor do quadrado */
            top: 30%; /* posição inicial */
            left: 20%; /* posição inicial */
           

}
.visoria {
            position: absolute;
           
            overflow: hidden;
            height: 210px; /* altura da área visível */
            width: 100px;  /* largura da área visível */
            top: 20%;       /* posição inicial vertical */
            left: 20%;      /* posição inicial horizontal */
        }

       
.jolia{
            position: absolute;
            width: 120px;
            height: 120px;
            top:85%;
            right: 88%;
          }

          .tia{
            position: absolute;
            width: 100px;
            height: 100px;
            top:40%;
            right: 200px;
          }
        .entrada{
            display:block;
         
            height: 100%;
            width: 4%;
            background-color: rgb(84, 47, 37);
            position: relative;
             padding-top:50%;
            margin-right: 20px;
           
        }
        .door{
            position: absolute;
            width: 40px; /* Largura do quadrado */
            height: 28%; /* Altura do quadrado */
            background-color: rgb(75, 43, 24); /* Cor marrom */
            top: 50%;
            left: 65%;
            transform: translate(-50%, -50%);
        }
        body {
            
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-image: url('https://i.pinimg.com/736x/a9/b9/8c/a9b98c3574eaad53955a8bc73564792e.jpg');
            background-color: #937d7d;
        }
    .armario2{
        display: block;
        float: left;
        
        height: 20%;
        width: 18%;
       margin-top:0%;
    }   

        canvas {
            display: block;
            background-color: #2c3e50; /* Cor do fundo do canvas */
        }

        #square {
            position: absolute;
            width: 100px;
            height: 100px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        #square img {
            width: 100%;
            height: 100%;
        }

 
        #botao-interacao {
            display: none;
            position: absolute;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 20px;
            cursor: pointer;
        }
 #open-button {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
      background-color: green;
      padding: 10px;
      color: white;
      font-size: 16px;
      border: none;
      cursor: pointer;
    }
    .elemento {
  position: relative;
  width: 200px;
  height: 200px;
  background-color: #3498db;
  border-radius: 10px;
}

.botao {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  padding: 10px;
  background-color: #2ecc71;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  display: none;
}

        #textbox {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            background-color: #fff;
            padding: 20px;
            transform: translate(-50%, -50%);
            border: 2px solid #000;
            width: 300px;
            height: 200px;
            text-align: center;
        }

        
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
    </style>
</head>
<body>

<canvas id="Canva" width="100" height="100" style="background-color: red;"></canvas> <!-- Tamanho da tela -->

<canvas id="gameCanvas" width="80" height="60"></canvas>
<div id="square">
    <img id="square-gif" src="./dimiparado.png" width="70" alt="Personagem">
</div>

<!-- The Modal -->
<div id="modalPers1" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <p>Some text in the Modal..</p>
    </div>
</div>
<div id="modalPers2" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <p>Some text in the Modal..</p>
    </div>
</div>
<div id="modalPers3" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <p>Some text in the Modal..</p>
    </div>
</div>


<script>
    const canvas = document.getElementById('Canva');
    const square = document.getElementById('square');
    const squareGif = document.getElementById('square-gif');
    const ctx = canvas.getContext('2d');
    const tia = document.querySelector('.tia'); 
    const jolia = document.querySelector('.jolia'); 
    const vioria = document.querySelector('.vioria'); 
    const openButton = document.getElementById("open-button");
    const elemento = document.getElementById('elemento');
const botao = document.getElementById('botao');


  function verificarProximidade() {
  const posSquare = square.getBoundingClientRect();
  const posElemento = tia.getBoundingClientRect();

let distancia = posElemento.x-posSquare.x;
  console.log(distancia);
  if ( distancia < 150) {
    botao.style.display = 'block';
    console.log('colidiu');
  } else {
    botao.style.display = 'none';
    console.log('ainda nao');
  }
}
  
document.addEventListener('keydown', function(e) {
  const step = 5; // A cada tecla pressionada, o personagem se move 5px

  if (e.key === 'ArrowUp') {
    personagem.style.top = (parseInt(personagem.style.top || 0) - step) + 'px';
  } else if (e.key === 'ArrowDown') {
    personagem.style.top = (parseInt(personagem.style.top || 0) + step) + 'px';
  } else if (e.key === 'ArrowLeft') {
    personagem.style.left = (parseInt(personagem.style.left || 0) - step) + 'px';
  } else if (e.key === 'ArrowRight') {
    personagem.style.left = (parseInt(personagem.style.left || 0) + step) + 'px';
  }

  // Verifica a proximidade após o movimento
  verificarProximidade();
});

// Verifica a proximidade inicialmente
verificarProximidade();



    let posX = canvas.width / -2; 
    let posY = canvas.height / -30;
    const step = 15; // Quantidade de movimento em pixels
    const width = square.offsetWidth;  // Largura do quadrado
    const height = square.offsetHeight; // Altura do quadrado
    let gifAtivo = false; // Controle para saber se o gif está animado ou não

    // Variável de controle das teclas pressionadas
    let movingKeys = {
        w: false,
        a: false,
        s: false,
        d: false
    };

    function verificarColisao() {
    const rectPersonagem = square.getBoundingClientRect();
    const rectTia = tia.getBoundingClientRect();
    const rectJolia = jolia.getBoundingClientRect();
    const rectvioria = vioria.getBoundingClientRect();

    
    const colisaoTia = !(rectPersonagem.right <= rectTia.left || 
                        rectPersonagem.left >= rectTia.right || 
                        rectPersonagem.bottom <= rectTia.top || 
                        rectPersonagem.top >= rectTia.bottom);
                        
                        

    
    const colisaoJolia = !(rectPersonagem.right <= rectJolia.left || 
                          rectPersonagem.left >= rectJolia.right || 
                          rectPersonagem.bottom <= rectJolia.top || 
                          rectPersonagem.top >= rectJolia.bottom);

  const colisaovioria= !(rectPersonagem.right <= rectvioria.left || 
                        rectPersonagem.left >= rectvioria.right || 
                        rectPersonagem.bottom <= rectvioria.top || 
                        rectPersonagem.top >= rectvioria.bottom);
                        
    
    return colisaoTia || colisaoJolia ||colisaovioria;
}






function moverPersonagem() {
    // Verifica se as teclas estão pressionadas e move o personagem
    if (movingKeys.w) {
        // Permite o movimento para cima sem bloquear completamente (não importa a colisão)
        posY = Math.max(posY - step, -210);  // Limite superior
        squareGif.src = './dimi de costa (1).gif';
    }
    if (movingKeys.s) {
        // Permite o movimento para baixo sem bloquear completamente
        posY = Math.min(posY + step, window.innerHeight - height, 200);  // Limite inferior
        squareGif.src = './didmitrinho (1).gif';
    }
    if (movingKeys.a) {
        // Permite o movimento para a esquerda sem bloquear completamente
        posX = Math.max(posX - step, -620);  // Limite esquerdo
        squareGif.src = './dimi esq.gif';
//squareGif.classList.remove("oitudobem");
        //squareGif.classList.add("helllomoto");
        square.style.transform = `translate(${posX}px, ${posY}px) rotateY(180deg)`;
    }
    if (movingKeys.d) {
        // Permite o movimento para a direita sem bloquear completamente
        posX = Math.min(posX + step, window.innerWidth - width, 590);  // Limite direito
        squareGif.src = './dimi dir.gif';
        //squareGif.classList.add("oitudobem");
        square.style.transform = `translate(${posX}px, ${posY}px) rotateY(0deg)`;
    }

    // Verifica se o personagem está colidindo com a tia e ajusta a posição
    if (verificarColisao()) {
        // Caso haja colisão, move o personagem para fora da colisão (evita que ele fique "preso").
        // Por exemplo, se a colisão ocorrer na direção 'a' (esquerda), mova o personagem para a direita;
        // caso contrário, move para a esquerda.
        if (movingKeys.a) {
            posX = Math.min(posX + step, window.innerWidth - width, 200); // Mover para direita caso tenha colidido
        }
        if (movingKeys.d) {
            posX = Math.max(posX - step, -620); // Mover para esquerda caso tenha colidido
        }
        if (movingKeys.w) {
            posY = Math.min(posY + step, 200, window.innerHeight - height); // Mover para baixo caso tenha colidido
        }
        if (movingKeys.s) {
            posY = Math.max(posY - step, -210); // Mover para cima caso tenha colidido
        }
    }

    // Atualiza a posição do quadrado na tela
    square.style.transform = `translate(${posX}px, ${posY}px)`;
}

       
    
    

  
    // Detecta quando uma tecla é pressionada
    window.addEventListener('keydown', (e) => {
        if (['w', 'a', 's', 'd'].includes(e.key)) {
            movingKeys[e.key] = true;
            moverPersonagem();
        }
    });

    // Detecta quando uma tecla é liberada
    window.addEventListener('keyup', (e) => {
        if (['w', 'a', 's', 'd'].includes(e.key)) {
            movingKeys[e.key] = false;
        }
        
        // Se nenhuma tecla de movimento for pressionada, o gif será parado
        if (!Object.values(movingKeys).includes(true)) {
            gifAtivo = false;
            squareGif.src = './dimiparado.png'; // Coloca a imagem estática quando o gif não está em movimento
        }
    });

    // Função para desenhar o canvas (opcional, você pode adicionar outras coisas no canvas)
    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height); // Limpa o canvas
        // Desenha o personagem no canvas (apenas exemplo, não será necessário com o div "square" controlando a posição)
        // ctx.fillRect(posX, posY, 70, 70); // Desenha o quadrado (personagem)
        requestAnimationFrame(draw); // Redesenha o canvas
    }

    // Inicia o desenho contínuo (opcional, se quiser adicionar outras coisas no canvas)
    draw();


// Get the modal
var modalPers1 = document.getElementById("modalPers1");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that  '' closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
btn.onclick = function() {
    modalPers1.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
    modalPers1.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modalPers1) {
    modalPers1.style.display = "none";
  }
}

// Checar colisão com o mouse
function checkCollision(mouseX, mouseY) {
    if (mouseX >= square.x && mouseX <= square.x + square.width &&
        mouseY >= square.y && mouseY <= square.y + square.height) {
        return true; // Colidiu com o quadrado
    }
    return false;
}





// Evento de clique do mouse para verificar colisão com o quadrado

// Atualizar o canvas
function updateCanvas() {
    drawSquare(); // Desenha o quadrado (com a imagem)
    requestAnimationFrame(updateCanvas); // Faz o loop de animação
}

img.onload = function() {
    updateCanvas(); // Inicia o loop de animação quando a imagem carregar
}


</script>


</body>
</html>